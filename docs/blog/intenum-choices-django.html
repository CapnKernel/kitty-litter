<!DOCTYPE HTML>
<!--
	Future Imperfect by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
	<title>Kitty Litter - </title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="/css/main.css" />
</head>
<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Header -->
		<header id="header">
			<h1><a href="/index.html"> <img src="/images/logo.png"> Kitty Litter</a></h1>
			<nav class="links">
				<ul>
  <li><a href="/blog/index.html">Blog</a></li>
</ul>

			</nav>
			<nav class="main">
				<ul>
					<!-- <li class="search">
						<a class="fa-search" href="#search">Search</a>
						<form id="search" method="get" action="#">
							<input type="text" name="query" placeholder="Search" />
						</form>
					</li> -->
					<li class="menu">
						<a class="fa-bars" href="#menu">Menu</a>
					</li>
				</ul>
			</nav>
		</header>

		<!-- Menu -->
		<section id="menu">
			<!-- Search -->
			<!-- <section>
				<form class="search" method="get" action="#">
					<input type="text" name="query" placeholder="Search" />
				</form>
			</section> -->

			<!-- Links -->
			<section>
				<ul class="links">
			
					<li>
						<a href="/blog/index.html">
							<h3>Blog</h3>
							<p></p>
						</a>
					</li>
			
				</ul>
			</section>

			<!-- Actions -->
			<!-- <section>
				<ul class="actions stacked">
					<li><a href="#" class="button large fit">Log In</a></li>
				</ul>
			</section> -->
		</section>

		<!-- Main -->
		<div id="main">
			
			<article class="post"><p>So, we've all needed a <code>choices</code> list in Django at one time or another, right?</p>

<p>And from the docs we see the example code:</p>

<pre><code>YEAR_IN_SCHOOL_CHOICES = (
    ('FR', 'Freshman'),
    ('SO', 'Sophomore'),
    ('JR', 'Junior'),
    ('SR', 'Senior'),
)
</code></pre>

<p>Which is then quickly amended to:</p>

<pre><code>class Student(models.Model):
    FRESHMAN = 'FR'
    SOPHOMORE = 'SO'
    JUNIOR = 'JR'
    SENIOR = 'SR'
    YEAR_IN_SCHOOL_CHOICES = (
        (FRESHMAN, 'Freshman'),
        (SOPHOMORE, 'Sophomore'),
        (JUNIOR, 'Junior'),
        (SENIOR, 'Senior'),
    )
    year_in_school = models.CharField(max_length=2,
                                      choices=YEAR_IN_SCHOOL_CHOICES,
                                      default=FRESHMAN)
</code></pre>

<p>Why?  Because this avoids the problem of <code>magic values</code>, an aspect of keeping DRY.</p>

<p>Magic values are constants that have meaning; they become a problem [especially with numbers] because you can't be certain if the values are coincidentally the same (i.e. this value is the 2px margin we want in common, but that one just happens to <em>also</em> be 2px...).  Much better to give them names, so we can know what the value represents, and know it's not coincidentally the same as another value.</p>

<p>It also means changing the value throughout your code can happen in once place.</p>

<p>Now the values are defined in one place, and easy to access.  Instead of having to remember to use 'JR', you can put Student.JUNIOR ; namespacing is thrown in free!</p>

<p>What's wrong with this?  Well, nothing, really... except when you have multiple choice fields on the same model.</p>

<h2>A possible solution...</h2>

<p>As of Python 3.4, we have the <a href="https://docs.python.org/3/library/enum.html">enum</a> lib.  For older Python's, there's the <code>Enum34</code> package.</p>

<p>This gives us the use <code>Enum</code> and <code>IntEnum</code> classes.</p>

<p>The above example could be rewritten as:</p>

<pre><code>class Student(models.Model):
    class YEAR(Enum):
        FRESHMAN = 'FR'
        SOHPOMORE = 'SO'
        JUNIOR = 'JR'
        SENIOR = 'SR'
</code></pre>

<p>Now we can reference the values using Student.YEAR.JUNIOR.  Not bad.</p>

<pre><code>&gt;&gt;&gt; Student.YEAR.JUNIOR
&lt;YEAR.JUNIOR: 'JR'&gt;
</code></pre>

<p>Each values provides its name and value as attributes:</p>

<pre><code>&gt;&gt;&gt; Student.YEAR.JUNIOR.name
'JUNIOR'
&gt;&gt;&gt; Student.YEAR.JUNIOR.value
'JR'
</code></pre>

<p>This helps us with our last step: to provide this in a way <code>choices=</code> will accept.</p>

<p>Fortunately, Enum <em>classes</em> are iterable:</p>

<pre><code>&gt;&gt;&gt; list(Student.YEAR)
[&lt;YEAR.FRESHMAN: 'FR'&gt;, &lt;YEAR.SOHPOMORE: 'SO'&gt;, &lt;YEAR.JUNIOR: 'JR'&gt;, &lt;YEAR.SENIOR: 'SR'&gt;]
</code></pre>

<p>So we can build choices by just:</p>

<pre><code>    year_in_school = models.CharField(max_length=2,
                                          choices=((x.value, x.name.title()) for x in YEAR),
                                          default=FRESHMAN)
</code></pre>

<h2>IntEnum</h2>

<p>When your values are all integers, there's <code>IntEnum</code>.</p>

<pre><code>class STATE(IntEnum):
    CANCELLED = -1
    PENDING = 0
    DECLINED = 1
    APPROVED = 2
</code></pre>

<p>This provides the same thing, but guarantees the values are integers.</p>

<h2>Belt and braces</h2>

<p>Finally, just to protect us from us... there's the <code>enum.unique</code> decorator.  This helps ensure that no two names have the same value.</p>

<pre><code>@enum.unique
class STATE(enum.IntEnum):
    CANCELLED = -1
    PENDING = 0
    DECLINED = 1
    APPROVED = 2
</code></pre>
</article>
			
		</div>

		<!-- Sidebar -->
		<section id="sidebar">
			<!-- Intro -->
			<section id="intro">
				<a href="/" class="logo"><img src="images/logo.jpg" alt="" /></a>
				<header>
					<h2>IntEnum for Choices in Django</h2>
					<!-- <p>IntEnum for Choices in Django</p> -->
				</header>
			</section>
			

			<!-- Mini Posts -->
			<section>
				<div class="mini-posts">

					<!-- Mini Post -->
					<!-- <article class="mini-post">
						<header>
							<h3><a href="single.html">Vitae sed condimentum</a></h3>
							<time class="published" datetime="2015-10-20">October 20, 2015</time>
							<a href="#" class="author"><img src="images/avatar.jpg" alt="" /></a>
						</header>
						<a href="single.html" class="image"><img src="images/pic04.jpg" alt="" /></a>
					</article> -->

				</div>
			</section>
			

			<!-- Posts List -->
			<!-- <section>
				<ul class="posts">
					<li>
						<article>
							<header>
								<h3><a href="single.html">Congue ullam corper lorem ipsum dolor</a></h3>
								<time class="published" datetime="2015-10-06">October 7, 2015</time>
							</header>
							<a href="single.html" class="image"><img src="images/pic12.jpg" alt="" /></a>
						</article>
					</li>
				</ul>
			</section> -->

			<!-- About -->
			<section class="blurb">
				<h2>About</h2>
				<p>Hi!</p>
				<p>I'm <strong>FunkyBob</strong>, also know as <small>Curtis Maloney</small>.</p>
				<p>Contained herein are some things I thought important enough to write about.</p>
				<!-- <ul class="actions">
					<li><a href="#" class="button">Learn More</a></li>
				</ul> -->
			</section>

			<!-- Footer -->
			<section id="footer">
				<ul class="icons">
					<li><a href="https://twitter.com/BunkyFob" class="fa-twitter"><span class="label">Twitter</span></a></li>
					<!-- <li><a href="#" class="fa-facebook"><span class="label">Facebook</span></a></li>
					<li><a href="#" class="fa-instagram"><span class="label">Instagram</span></a></li>
					<li><a href="#" class="fa-rss"><span class="label">RSS</span></a></li>
					<li><a href="#" class="fa-envelope"><span class="label">Email</span></a></li> -->
				</ul>
				<p class="copyright">&copy; Untitled. Design: <a href="http://html5up.net">HTML5 UP</a>. Images: <a href="http://unsplash.com">Unsplash</a>.</p>
			</section>

		</section>

	</div>

	<!-- Scripts -->
	<script src="/js/jquery.min.js"></script>
	<script src="/js/browser.min.js"></script>
	<script src="/js/breakpoints.min.js"></script>
	<script src="/js/util.js"></script>
	<script src="/js/main.js"></script>

</body>
</html>
